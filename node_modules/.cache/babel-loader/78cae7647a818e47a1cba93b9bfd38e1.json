{"ast":null,"code":"/*!\n * Viewer.js v1.10.5\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2022-04-05T08:21:02.491Z\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Viewer = factory());\n})(this, function () {\n  'use strict';\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      enumerableOnly && (symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      })), keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = null != arguments[i] ? arguments[i] : {};\n      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n\n    return target;\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    }, _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n\n    /**\n     * Enable to request fullscreen when play.\n     * {@link https://developer.mozilla.org/en-US/docs/Web/API/FullscreenOptions}\n     * @type {boolean|FullscreenOptions}\n     */\n    fullscreen: true,\n\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n\n    /**\n     * Define the initial index of image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n\n    /**\n     * Focus the viewer when initialized.\n     * @type {boolean}\n     */\n    focus: true,\n\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    move: null,\n    moved: null,\n    rotate: null,\n    rotated: null,\n    scale: null,\n    scaled: null,\n    zoom: null,\n    zoomed: null,\n    play: null,\n    stop: null\n  };\n  var TEMPLATE = '<div class=\"viewer-container\" tabindex=\"-1\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\" role=\"navigation\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\" role=\"alert\" aria-hidden=\"true\"></div>' + '<div class=\"viewer-button\" data-viewer-action=\"mix\" role=\"button\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer'; // Actions\n\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom'; // Classes\n\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\"); // Native events\n\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_FOCUSIN = 'focusin';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_ERROR = 'error';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_RESIZE = 'resize';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_WHEEL = 'wheel'; // Custom events\n\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_MOVE = 'move';\n  var EVENT_MOVED = 'moved';\n  var EVENT_ROTATE = 'rotate';\n  var EVENT_ROTATED = 'rotated';\n  var EVENT_SCALE = 'scale';\n  var EVENT_SCALED = 'scaled';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed';\n  var EVENT_PLAY = 'play';\n  var EVENT_STOP = 'stop'; // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\"); // RegExps\n\n  var REGEXP_SPACES = /\\s\\s*/; // Misc\n\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * Check if the given value is not a number.\n   */\n\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n        var length = data.length;\n        var i;\n\n        for (i = 0; i < length; i += 1) {\n          if (callback.call(data, data[i], i, data) === false) {\n            break;\n          }\n        }\n      } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n\n\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return obj;\n  };\n\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n\n\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @param {Object} options - The additional event options.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n\n  function dispatchEvent(element, type, data, options) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, _objectSpread2({\n        bubbles: true,\n        cancelable: true,\n        detail: data\n      }, options));\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n\n\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n\n  var IS_SAFARI = WINDOW.navigator && /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img'); // Modern browsers (except Safari)\n\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n\n    var body = document.body || document.documentElement;\n\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src; // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n\n    return newImage;\n  }\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n\n\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n\n      default:\n        return '';\n    }\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n          parent = this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n\n      var element = this.element,\n          options = this.options,\n          list = this.list;\n      var items = []; // initList may be called in this.update, so should keep idempotent\n\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n\n        var url = _this.getImageURL(image);\n\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n          img.src = src || url;\n          img.alt = alt;\n          img.setAttribute('data-original-url', url || src);\n          item.setAttribute('data-index', index);\n          item.setAttribute('data-viewer-action', 'view');\n          item.setAttribute('role', 'button');\n\n          if (options.keyboard) {\n            item.setAttribute('tabindex', 0);\n          }\n\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        var onLoad;\n        var onError;\n        setData(image, 'filled', true);\n\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n\n        addListener(image, EVENT_LOAD, onLoad = function onLoad(event) {\n          removeListener(image, EVENT_ERROR, onError);\n\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n      });\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList() {\n      var index = this.index;\n      var item = this.items[index];\n\n      if (!item) {\n        return;\n      }\n\n      var next = item.nextElementSibling;\n      var gutter = parseInt(window.getComputedStyle(next || item).marginLeft, 10);\n      var offsetWidth = item.offsetWidth;\n      var outerWidth = offsetWidth + gutter; // Place the active item in the center of the screen\n\n      setStyle(this.list, assign({\n        width: outerWidth * this.length - gutter\n      }, getTransforms({\n        translateX: (this.viewerData.width - offsetWidth) / 2 - outerWidth * index\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n\n      var options = this.options,\n          image = this.image,\n          viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = Math.min(width * 0.9, naturalWidth);\n        height = Math.min(height * 0.9, naturalHeight);\n        var left = (viewerWidth - width) / 2;\n        var top = (viewerHeight - height) / 2;\n        var imageData = {\n          left: left,\n          top: top,\n          x: left,\n          y: top,\n          width: width,\n          height: height,\n          oldRatio: 1,\n          ratio: width / naturalWidth,\n          aspectRatio: aspectRatio,\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight\n        };\n        var initialImageData = assign({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n\n      var image = this.image,\n          imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.x,\n        marginTop: imageData.y\n      }, getTransforms(imageData)));\n\n      if (done) {\n        if ((this.viewing || this.moving || this.rotating || this.scaling || this.zooming) && this.options.transition && hasClass(image, CLASS_TRANSITION)) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      // this.image only defined after viewed\n      if (this.viewing || this.viewed) {\n        var image = this.image;\n\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }\n  };\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n  var handlers = {\n    click: function click(event) {\n      var options = this.options,\n          imageData = this.imageData;\n      var target = event.target;\n      var action = getData(target, DATA_ACTION);\n\n      if (!action && target.localName === 'img' && target.parentElement.localName === 'li') {\n        target = target.parentElement;\n        action = getData(target, DATA_ACTION);\n      } // Cancel the emulated click when the native click event was triggered.\n\n\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n\n        case 'hide':\n          this.hide();\n          break;\n\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          this.toggle();\n          break;\n\n        case 'reset':\n          this.reset();\n          break;\n\n        case 'prev':\n          this.prev(options.loop);\n          break;\n\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n\n        case 'next':\n          this.next(options.loop);\n          break;\n\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (this.played) {\n            this.stop();\n          }\n\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        } // XXX: No pageX/Y properties in custom event, fallback to the original event.\n\n\n        this.toggle(event.isTrusted ? event : event.detail && event.detail.originalEvent);\n      }\n    },\n    load: function load() {\n      var _this = this;\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n\n      var element = this.element,\n          options = this.options,\n          image = this.image,\n          index = this.index,\n          viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:relative;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          }, {\n            cancelable: false\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n\n      if (!options.keyboard) {\n        return;\n      }\n\n      var keyCode = event.keyCode || event.which || event.charCode;\n\n      switch (keyCode) {\n        // Enter\n        case 13:\n          if (this.viewer.contains(event.target)) {\n            this.click(event);\n          }\n\n          break;\n      }\n\n      if (!this.fulled) {\n        return;\n      }\n\n      switch (keyCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n        // Space\n\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n\n          break;\n        // ArrowLeft\n\n        case 37:\n          this.prev(options.loop);\n          break;\n        // ArrowUp\n\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom in\n\n          this.zoom(options.zoomRatio, true);\n          break;\n        // ArrowRight\n\n        case 39:\n          this.next(options.loop);\n          break;\n        // ArrowDown\n\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom out\n\n          this.zoom(-options.zoomRatio, true);\n          break;\n        // Ctrl + 0\n\n        case 48: // Fall through\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.localName === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var buttons = event.buttons,\n          button = event.button;\n\n      if (!this.viewed || this.showing || this.viewing || this.hiding // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      } // Prevent default behaviours as page zooming in touch devices.\n\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      var action = options.movable ? ACTION_MOVE : false;\n\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n          action = this.action;\n\n      if (!this.viewed || !action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n\n      var options = this.options,\n          action = this.action,\n          pointers = this.pointers;\n      var pointer;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = false; // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false; // This timeout will be cleared later when a native dblclick event is triggering\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          } else {\n            this.imageClicked = true; // The default timing of a double click in Windows is 500 ms\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n\n      if (!this.viewed) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, true, event);\n    }\n  };\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n\n      if (!this.ready) {\n        this.build();\n\n        if (this.ready) {\n          this.show(immediate);\n        }\n\n        return this;\n      }\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('aria-hidden');\n\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n\n      return this;\n    },\n\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var _this = this;\n\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n\n      this.hiding = true;\n\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var viewer = this.viewer,\n          image = this.image;\n\n      var hideImmediately = function hideImmediately() {\n        removeClass(viewer, CLASS_IN);\n\n        _this.hidden();\n      };\n\n      if (options.transition && !immediate) {\n        var onViewerTransitionEnd = function onViewerTransitionEnd(event) {\n          // Ignore all propagating `transitionend` events (#275).\n          if (event && event.target === viewer) {\n            removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n\n            _this.hidden();\n          }\n        };\n\n        var onImageTransitionEnd = function onImageTransitionEnd() {\n          // In case of show the viewer by `viewer.show(true)` previously (#407).\n          if (hasClass(viewer, CLASS_TRANSITION)) {\n            addListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            removeClass(viewer, CLASS_IN);\n          } else {\n            hideImmediately();\n          }\n        };\n\n        this.transitioning = {\n          abort: function abort() {\n            if (_this.viewed && hasClass(image, CLASS_TRANSITION)) {\n              removeListener(image, EVENT_TRANSITION_END, onImageTransitionEnd);\n            } else if (hasClass(viewer, CLASS_TRANSITION)) {\n              removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            }\n          }\n        }; // In case of hiding the viewer when holding on the image (#255),\n        // note that the `CLASS_TRANSITION` class will be removed on pointer down.\n\n        if (this.viewed && hasClass(image, CLASS_TRANSITION)) {\n          addListener(image, EVENT_TRANSITION_END, onImageTransitionEnd, {\n            once: true\n          });\n          this.zoomTo(0, false, null, true);\n        } else {\n          onImageTransitionEnd();\n        }\n      } else {\n        hideImmediately();\n      }\n\n      return this;\n    },\n\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this2 = this;\n\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var element = this.element,\n          options = this.options,\n          title = this.title,\n          canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n\n      var activeItem = this.items[this.index];\n\n      if (activeItem) {\n        removeClass(activeItem, CLASS_ACTIVE);\n        activeItem.removeAttribute('aria-selected');\n      }\n\n      addClass(item, CLASS_ACTIVE);\n      item.setAttribute('aria-selected', true);\n\n      if (options.focus) {\n        item.focus();\n      }\n\n      this.image = image;\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n\n      canvas.innerHTML = '';\n      canvas.appendChild(image); // Center current item\n\n      this.renderList(); // Clear title\n\n      title.innerHTML = ''; // Generate title after viewed\n\n      var onViewed = function onViewed() {\n        var imageData = _this2.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this2, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n\n      var onLoad;\n      var onError;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n\n          if (image.complete) {\n            if (_this2.imageRendering) {\n              _this2.imageRendering.abort();\n            } else if (_this2.imageInitializing) {\n              _this2.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n\n            if (_this2.timeout) {\n              clearTimeout(_this2.timeout);\n            }\n          }\n        }\n      };\n\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n          removeListener(image, EVENT_ERROR, onError);\n\n          _this2.load();\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (_this2.timeout) {\n            clearTimeout(_this2.timeout);\n            _this2.timeout = false;\n          }\n\n          removeClass(image, CLASS_INVISIBLE);\n\n          if (options.loading) {\n            removeClass(_this2.canvas, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        } // Make the image visible if it fails to load within 1s\n\n\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this2.timeout = false;\n        }, 1000);\n      }\n\n      return this;\n    },\n\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * Move the image with relative offsets.\n     * @param {number} x - The moving distance in the horizontal direction.\n     * @param {number} [y=x] The moving distance in the vertical direction.\n     * @returns {Viewer} this\n     */\n    move: function move(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(x) ? x : imageData.x + Number(x), isUndefined(y) ? y : imageData.y + Number(y));\n      return this;\n    },\n\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The new position in the horizontal direction.\n     * @param {number} [y=x] - The new position in the vertical direction.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var _this3 = this;\n\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.viewed && !this.played && options.movable) {\n        var oldX = imageData.x;\n        var oldY = imageData.y;\n        var changed = false;\n\n        if (isNumber(x)) {\n          changed = true;\n        } else {\n          x = oldX;\n        }\n\n        if (isNumber(y)) {\n          changed = true;\n        } else {\n          y = oldY;\n        }\n\n        if (changed) {\n          if (isFunction(options.move)) {\n            addListener(element, EVENT_MOVE, options.move, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_MOVE, {\n            x: x,\n            y: y,\n            oldX: oldX,\n            oldY: oldY,\n            originalEvent: _originalEvent\n          }) === false) {\n            return this;\n          }\n\n          imageData.x = x;\n          imageData.y = y;\n          imageData.left = x;\n          imageData.top = y;\n          this.moving = true;\n          this.renderImage(function () {\n            _this3.moving = false;\n\n            if (isFunction(options.moved)) {\n              addListener(element, EVENT_MOVED, options.moved, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_MOVED, {\n              x: x,\n              y: y,\n              oldX: oldX,\n              oldY: oldY,\n              originalEvent: _originalEvent\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var _this4 = this;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.viewed && !this.played && options.rotatable) {\n        var oldDegree = imageData.rotate;\n\n        if (isFunction(options.rotate)) {\n          addListener(element, EVENT_ROTATE, options.rotate, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ROTATE, {\n          degree: degree,\n          oldDegree: oldDegree\n        }) === false) {\n          return this;\n        }\n\n        imageData.rotate = degree;\n        this.rotating = true;\n        this.renderImage(function () {\n          _this4.rotating = false;\n\n          if (isFunction(options.rotated)) {\n            addListener(element, EVENT_ROTATED, options.rotated, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ROTATED, {\n            degree: degree,\n            oldDegree: oldDegree\n          }, {\n            cancelable: false\n          });\n        });\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var _this5 = this;\n\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.viewed && !this.played && options.scalable) {\n        var oldScaleX = imageData.scaleX;\n        var oldScaleY = imageData.scaleY;\n        var changed = false;\n\n        if (isNumber(scaleX)) {\n          changed = true;\n        } else {\n          scaleX = oldScaleX;\n        }\n\n        if (isNumber(scaleY)) {\n          changed = true;\n        } else {\n          scaleY = oldScaleY;\n        }\n\n        if (changed) {\n          if (isFunction(options.scale)) {\n            addListener(element, EVENT_SCALE, options.scale, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_SCALE, {\n            scaleX: scaleX,\n            scaleY: scaleY,\n            oldScaleX: oldScaleX,\n            oldScaleY: oldScaleY\n          }) === false) {\n            return this;\n          }\n\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n          this.scaling = true;\n          this.renderImage(function () {\n            _this5.scaling = false;\n\n            if (isFunction(options.scaled)) {\n              addListener(element, EVENT_SCALED, options.scaled, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_SCALED, {\n              scaleX: scaleX,\n              scaleY: scaleY,\n              oldScaleX: oldScaleX,\n              oldScaleY: oldScaleY\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n      return this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this6 = this;\n\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _zoomable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n      var element = this.element,\n          options = this.options,\n          pointers = this.pointers,\n          imageData = this.imageData;\n      var x = imageData.x,\n          y = imageData.y,\n          width = imageData.width,\n          height = imageData.height,\n          naturalWidth = imageData.naturalWidth,\n          naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (_originalEvent) {\n          switch (_originalEvent.type) {\n            case 'wheel':\n              if (options.zoomRatio >= 0.055 && ratio > 0.95 && ratio < 1.05) {\n                ratio = 1;\n              }\n\n              break;\n\n            case 'pointermove':\n            case 'touchmove':\n            case 'mousemove':\n              if (ratio > 0.99 && ratio < 1.01) {\n                ratio = 1;\n              }\n\n              break;\n          }\n        }\n\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = imageData.ratio;\n\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        this.zooming = true;\n\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length > 0 ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          imageData.x -= offsetWidth * ((center.pageX - offset.left - x) / width);\n          imageData.y -= offsetHeight * ((center.pageY - offset.top - y) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.x -= offsetWidth / 2;\n          imageData.y -= offsetHeight / 2;\n        }\n\n        imageData.left = imageData.x;\n        imageData.top = imageData.y;\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.oldRatio = oldRatio;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this6.zooming = false;\n\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          }, {\n            cancelable: false\n          });\n        });\n\n        if (hasTooltip) {\n          this.tooltip();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Play the images\n     * @param {boolean|FullscreenOptions} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this7 = this;\n\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isShown || this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.play)) {\n        addListener(element, EVENT_PLAY, options.play, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_PLAY) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n\n      if (fullscreen) {\n        this.requestFullscreen(fullscreen);\n      }\n\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        var play = function play() {\n          _this7.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index += 1;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n            play();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          play();\n        }\n      }\n\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this8 = this;\n\n      if (!this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.stop)) {\n        addListener(element, EVENT_STOP, options.stop, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_STOP) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      this.played = false;\n      clearTimeout(this.playing);\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this8.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this9 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('style');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n\n      if (options.focus) {\n        this.enforceFocus();\n      }\n\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this9.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this10 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      if (options.focus) {\n        this.clearEnforceFocus();\n      }\n\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this10.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this11 = this;\n\n      var options = this.options,\n          tooltipBox = this.tooltipBox,\n          imageData = this.imageData;\n\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          tooltipBox.removeAttribute('aria-hidden'); // Force reflow to enable CSS3 transition\n\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.removeAttribute('aria-hidden');\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            tooltipBox.setAttribute('aria-hidden', true);\n            _this11.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this11.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.setAttribute('aria-hidden', true);\n        }\n\n        _this11.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n\n    /**\n     * Toggle the image size between its current size and natural size\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    toggle: function toggle() {\n      var _originalEvent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.imageData.oldRatio, true, _originalEvent);\n      } else {\n        this.zoomTo(1, true, _originalEvent);\n      }\n\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this12 = this;\n\n      var element = this.element,\n          options = this.options,\n          isImg = this.isImg; // Destroy viewer if the target image was deleted\n\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this12, image)) {\n            images.push(image);\n          }\n        } else if (_this12.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n\n      if (!images.length) {\n        return this;\n      }\n\n      this.images = images;\n      this.length = images.length;\n\n      if (this.ready) {\n        var changedIndexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n\n          if (image && img) {\n            if (image.src !== img.src // Title changed (#408)\n            || image.alt !== img.alt) {\n              changedIndexes.push(i);\n            }\n          } else {\n            changedIndexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var changedIndex = changedIndexes.indexOf(this.index);\n\n              if (changedIndex >= 0) {\n                this.viewed = false;\n                this.view(Math.max(Math.min(this.index - changedIndex, this.length - 1), 0));\n              } else {\n                var activeItem = this.items[this.index]; // Reactivate the current viewing item after reset the list.\n\n                addClass(activeItem, CLASS_ACTIVE);\n                activeItem.setAttribute('aria-selected', true);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n          options = this.options;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      this.destroyed = true;\n\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n\n      return url;\n    },\n    enforceFocus: function enforceFocus() {\n      var _this = this;\n\n      this.clearEnforceFocus();\n      addListener(document, EVENT_FOCUSIN, this.onFocusin = function (event) {\n        var viewer = _this.viewer;\n        var target = event.target;\n\n        if (target === document || target === viewer || viewer.contains(target)) {\n          return;\n        }\n\n        while (target) {\n          // Avoid conflicts with other modals (#474, #540)\n          if (target.getAttribute('tabindex') !== null || target.getAttribute('aria-modal') === 'true') {\n            return;\n          }\n\n          target = target.parentElement;\n        }\n\n        viewer.focus();\n      });\n    },\n    clearEnforceFocus: function clearEnforceFocus() {\n      if (this.onFocusin) {\n        removeListener(document, EVENT_FOCUSIN, this.onFocusin);\n        this.onFocusin = null;\n      }\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.initialBodyPaddingRight;\n    },\n    shown: function shown() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n\n      if (options.focus) {\n        viewer.focus();\n        this.enforceFocus();\n      }\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n\n      if (options.fucus) {\n        this.clearEnforceFocus();\n      }\n\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.close();\n      this.unbind();\n      addClass(viewer, CLASS_HIDE);\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      viewer.setAttribute('aria-hidden', true);\n      this.resetList();\n      this.resetImage();\n      this.hiding = false;\n\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_HIDDEN, null, {\n          cancelable: false\n        });\n      }\n    },\n    requestFullscreen: function requestFullscreen(options) {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement; // Element.requestFullscreen()\n\n        if (documentElement.requestFullscreen) {\n          // Avoid TypeError when convert `options` to dictionary\n          if (isPlainObject(options)) {\n            documentElement.requestFullscreen(options);\n          } else {\n            documentElement.requestFullscreen();\n          }\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]]; // In the case of the `pointers` object is empty (#421)\n\n      if (!pointer) {\n        return;\n      }\n\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          this.move(offsetX, offsetY, event);\n          break;\n        // Zoom the current image\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, event);\n          break;\n\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n\n            break;\n          }\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n          viewerData = this.viewerData;\n      return this.length > 1 && imageData.x >= 0 && imageData.y >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n  var AnotherViewer = WINDOW.Viewer;\n\n  var getUniqueID = function (id) {\n    return function () {\n      id += 1;\n      return id;\n    };\n  }(-1);\n\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Viewer);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.moving = false;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.rotating = false;\n      this.scaling = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.id = getUniqueID();\n      this.init();\n    }\n\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var element = this.element,\n            options = this.options;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this; // The `focus` option requires the `keyboard` option set to `true`.\n\n        if (options.focus && !options.keyboard) {\n          options.focus = false;\n        }\n\n        var isImg = element.localName === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody(); // Override `transition` option if it is not supported\n\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n\n        if (options.inline) {\n          var count = 0;\n\n          var progress = function progress() {\n            count += 1;\n\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              }; // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n\n                _this.build();\n              }, 0);\n            }\n          };\n\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                  removeListener(image, EVENT_ERROR, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              var onLoad;\n              var onError;\n              addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n                removeListener(image, EVENT_ERROR, onError);\n                progress();\n              }, {\n                once: true\n              });\n              addListener(image, EVENT_ERROR, onError = function onError() {\n                removeListener(image, EVENT_LOAD, onLoad);\n                progress();\n              }, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n\n            if (target.localName === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        viewer.id = \"\".concat(NAMESPACE).concat(this.id);\n        title.id = \"\".concat(NAMESPACE, \"Title\").concat(this.id);\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n\n        if (options.keyboard) {\n          button.setAttribute('tabindex', 0);\n        }\n\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n\n            if (options.keyboard) {\n              item.setAttribute('tabindex', 0);\n            }\n\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n\n          if (!container) {\n            container = this.body;\n          }\n\n          container.appendChild(viewer);\n        }\n\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n\n        this.ready = true;\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Viewer;\n  }();\n\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n  return Viewer;\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","globalThis","self","Viewer","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","value","DEFAULTS","backdrop","button","navbar","title","toolbar","className","container","fullscreen","inheritedAttributes","initialViewIndex","inline","interval","keyboard","focus","loading","loop","minWidth","minHeight","movable","rotatable","scalable","zoomable","zoomOnTouch","zoomOnWheel","slideOnTouch","toggleOnDblclick","tooltip","transition","zIndex","zIndexInline","zoomRatio","minZoomRatio","maxZoomRatio","url","ready","show","shown","hide","hidden","view","viewed","move","moved","rotate","rotated","scale","scaled","zoom","zoomed","play","stop","TEMPLATE","IS_BROWSER","window","document","WINDOW","IS_TOUCH_DEVICE","documentElement","HAS_POINTER_EVENT","NAMESPACE","ACTION_MOVE","ACTION_SWITCH","ACTION_ZOOM","CLASS_ACTIVE","concat","CLASS_CLOSE","CLASS_FADE","CLASS_FIXED","CLASS_FULLSCREEN","CLASS_FULLSCREEN_EXIT","CLASS_HIDE","CLASS_HIDE_MD_DOWN","CLASS_HIDE_SM_DOWN","CLASS_HIDE_XS_DOWN","CLASS_IN","CLASS_INVISIBLE","CLASS_LOADING","CLASS_MOVE","CLASS_OPEN","CLASS_SHOW","CLASS_TRANSITION","EVENT_CLICK","EVENT_DBLCLICK","EVENT_DRAG_START","EVENT_FOCUSIN","EVENT_KEY_DOWN","EVENT_LOAD","EVENT_ERROR","EVENT_TOUCH_END","EVENT_TOUCH_MOVE","EVENT_TOUCH_START","EVENT_POINTER_DOWN","EVENT_POINTER_MOVE","EVENT_POINTER_UP","EVENT_RESIZE","EVENT_TRANSITION_END","EVENT_WHEEL","EVENT_READY","EVENT_SHOW","EVENT_SHOWN","EVENT_HIDE","EVENT_HIDDEN","EVENT_VIEW","EVENT_VIEWED","EVENT_MOVE","EVENT_MOVED","EVENT_ROTATE","EVENT_ROTATED","EVENT_SCALE","EVENT_SCALED","EVENT_ZOOM","EVENT_ZOOMED","EVENT_PLAY","EVENT_STOP","DATA_ACTION","REGEXP_SPACES","BUTTONS","isString","isNaN","Number","isNumber","isUndefined","isObject","hasOwnProperty","isPlainObject","_constructor","call","error","isFunction","data","callback","Array","isArray","assign","_len","args","_key","arg","REGEXP_SUFFIX","setStyle","element","styles","style","property","test","escapeHTMLEntities","replace","hasClass","classList","contains","indexOf","addClass","elem","add","trim","removeClass","remove","toggleClass","added","REGEXP_HYPHENATE","hyphenate","toLowerCase","getData","name","dataset","getAttribute","setData","setAttribute","onceSupported","supported","once","listener","options","get","set","addEventListener","removeEventListener","removeListener","type","undefined","handler","split","event","listeners","addListener","_handler","_element$listeners","_len2","_key2","dispatchEvent","Event","CustomEvent","bubbles","cancelable","detail","createEvent","initCustomEvent","getOffset","box","getBoundingClientRect","left","pageXOffset","clientLeft","top","pageYOffset","clientTop","getTransforms","_ref","scaleX","scaleY","translateX","translateY","values","transform","join","WebkitTransform","msTransform","getImageNameFromURL","decodeURIComponent","IS_SAFARI","navigator","userAgent","getImageNaturalSizes","image","newImage","createElement","naturalWidth","naturalHeight","body","onload","width","height","removeChild","src","cssText","appendChild","getResponsiveClass","getMaxZoomRatio","pointers","pointers2","ratios","pointer","pointerId","pointer2","x1","Math","abs","startX","y1","startY","x2","endX","y2","endY","z1","sqrt","z2","ratio","sort","a","b","getPointer","_ref2","endOnly","pageX","pageY","end","timeStamp","Date","now","getPointersCenter","count","_ref3","render","initContainer","initViewer","initList","renderViewer","initBody","ownerDocument","scrollbarWidth","innerWidth","clientWidth","initialBodyPaddingRight","paddingRight","initialBodyComputedPaddingRight","getComputedStyle","containerData","innerHeight","parent","viewerData","max","offsetWidth","offsetHeight","parentData","fulled","viewer","_this","list","items","innerHTML","images","index","alt","getImageURL","item","img","firstElementChild","onLoad","onError","loadImage","renderList","next","nextElementSibling","gutter","parseInt","marginLeft","outerWidth","resetList","initImage","done","_this2","footerHeight","footer","viewerWidth","viewerHeight","oldImageData","imageData","sizingImage","imageInitializing","abort","aspectRatio","min","x","y","oldRatio","initialImageData","renderImage","_this3","marginTop","viewing","moving","rotating","scaling","zooming","onTransitionEnd","imageRendering","resetImage","parentNode","events","bind","canvas","onClick","click","onDragStart","dragstart","onPointerDown","pointerdown","onPointerMove","pointermove","onPointerUp","pointerup","onKeyDown","keydown","onResize","resize","onWheel","wheel","passive","capture","onDblclick","dblclick","unbind","handlers","action","localName","parentElement","isTrusted","clearTimeout","clickCanvasTimeout","played","exit","full","toggle","reset","prev","preventDefault","doubleClickImageTimeout","originalEvent","load","timeout","originalImage","parentWidth","parentHeight","filled","keyCode","which","charCode","ctrlKey","buttons","showing","hiding","pointerType","changedTouches","touch","identifier","isSwitchable","change","imageClicked","setTimeout","isShown","close","open","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","player","getElementsByTagName","_this4","wheeling","delta","deltaY","wheelDelta","methods","immediate","build","transitioning","id","removeAttribute","initialOffsetWidth","hideImmediately","onViewerTransitionEnd","onImageTransitionEnd","zoomTo","querySelector","activeItem","onViewed","complete","maxIndex","moveTo","_originalEvent","oldX","oldY","changed","degree","rotateTo","oldDegree","_scaleX","_scaleY","_this5","oldScaleX","oldScaleY","hasTooltip","_this6","_zoomable","newWidth","newHeight","offset","center","_this7","total","onLoadWhenPlay","requestFullscreen","referrerPolicy","playing","_this8","exitFullscreen","_this9","enforceFocus","_this10","clearEnforceFocus","_this11","tooltipBox","textContent","round","tooltipping","fading","update","_this12","isImg","destroy","querySelectorAll","changedIndexes","changedIndex","destroyed","delaying","initializing","onStart","others","onFocusin","parseFloat","fucus","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","mozRequestFullScreen","msRequestFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","offsetX","offsetY","absoluteOffsetX","p","AnotherViewer","getUniqueID","nodeType","Error","init","progress","template","custom","zoomButtons","slice","rotateButtons","scaleButtons","deep","size","rotates","position","insertBefore","nextSibling","noConflict","setDefaults"],"sources":["C:/Users/jppor/OneDrive/Documents/Proyectos/2021/elhuarike/web-app/node_modules/viewerjs/dist/viewer.js"],"sourcesContent":["/*!\n * Viewer.js v1.10.5\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2022-04-05T08:21:02.491Z\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Viewer = factory());\n})(this, (function () { 'use strict';\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      enumerableOnly && (symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      })), keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = null != arguments[i] ? arguments[i] : {};\n      i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n\n    return target;\n  }\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n      return typeof obj;\n    } : function (obj) {\n      return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    }, _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n\n    /**\n     * Enable to request fullscreen when play.\n     * {@link https://developer.mozilla.org/en-US/docs/Web/API/FullscreenOptions}\n     * @type {boolean|FullscreenOptions}\n     */\n    fullscreen: true,\n\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n\n    /**\n     * Define the initial index of image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n\n    /**\n     * Focus the viewer when initialized.\n     * @type {boolean}\n     */\n    focus: true,\n\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    move: null,\n    moved: null,\n    rotate: null,\n    rotated: null,\n    scale: null,\n    scaled: null,\n    zoom: null,\n    zoomed: null,\n    play: null,\n    stop: null\n  };\n\n  var TEMPLATE = '<div class=\"viewer-container\" tabindex=\"-1\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\" role=\"navigation\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\" role=\"alert\" aria-hidden=\"true\"></div>' + '<div class=\"viewer-button\" data-viewer-action=\"mix\" role=\"button\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer'; // Actions\n\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom'; // Classes\n\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\"); // Native events\n\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_FOCUSIN = 'focusin';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_ERROR = 'error';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_RESIZE = 'resize';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_WHEEL = 'wheel'; // Custom events\n\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_MOVE = 'move';\n  var EVENT_MOVED = 'moved';\n  var EVENT_ROTATE = 'rotate';\n  var EVENT_ROTATED = 'rotated';\n  var EVENT_SCALE = 'scale';\n  var EVENT_SCALED = 'scaled';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed';\n  var EVENT_PLAY = 'play';\n  var EVENT_STOP = 'stop'; // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\"); // RegExps\n\n  var REGEXP_SPACES = /\\s\\s*/; // Misc\n\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * Check if the given value is not a number.\n   */\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n        var length = data.length;\n        var i;\n\n        for (i = 0; i < length; i += 1) {\n          if (callback.call(data, data[i], i, data) === false) {\n            break;\n          }\n        }\n      } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return obj;\n  };\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @param {Object} options - The additional event options.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n  function dispatchEvent(element, type, data, options) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, _objectSpread2({\n        bubbles: true,\n        cancelable: true,\n        detail: data\n      }, options));\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n  var IS_SAFARI = WINDOW.navigator && /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img'); // Modern browsers (except Safari)\n\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n\n    var body = document.body || document.documentElement;\n\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src; // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n\n    return newImage;\n  }\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n\n      default:\n        return '';\n    }\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n          parent = this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n\n      var element = this.element,\n          options = this.options,\n          list = this.list;\n      var items = []; // initList may be called in this.update, so should keep idempotent\n\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n\n        var url = _this.getImageURL(image);\n\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n          img.src = src || url;\n          img.alt = alt;\n          img.setAttribute('data-original-url', url || src);\n          item.setAttribute('data-index', index);\n          item.setAttribute('data-viewer-action', 'view');\n          item.setAttribute('role', 'button');\n\n          if (options.keyboard) {\n            item.setAttribute('tabindex', 0);\n          }\n\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        var onLoad;\n        var onError;\n        setData(image, 'filled', true);\n\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n\n        addListener(image, EVENT_LOAD, onLoad = function onLoad(event) {\n          removeListener(image, EVENT_ERROR, onError);\n\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n      });\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList() {\n      var index = this.index;\n      var item = this.items[index];\n\n      if (!item) {\n        return;\n      }\n\n      var next = item.nextElementSibling;\n      var gutter = parseInt(window.getComputedStyle(next || item).marginLeft, 10);\n      var offsetWidth = item.offsetWidth;\n      var outerWidth = offsetWidth + gutter; // Place the active item in the center of the screen\n\n      setStyle(this.list, assign({\n        width: outerWidth * this.length - gutter\n      }, getTransforms({\n        translateX: (this.viewerData.width - offsetWidth) / 2 - outerWidth * index\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n\n      var options = this.options,\n          image = this.image,\n          viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = Math.min(width * 0.9, naturalWidth);\n        height = Math.min(height * 0.9, naturalHeight);\n        var left = (viewerWidth - width) / 2;\n        var top = (viewerHeight - height) / 2;\n        var imageData = {\n          left: left,\n          top: top,\n          x: left,\n          y: top,\n          width: width,\n          height: height,\n          oldRatio: 1,\n          ratio: width / naturalWidth,\n          aspectRatio: aspectRatio,\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight\n        };\n        var initialImageData = assign({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n\n      var image = this.image,\n          imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.x,\n        marginTop: imageData.y\n      }, getTransforms(imageData)));\n\n      if (done) {\n        if ((this.viewing || this.moving || this.rotating || this.scaling || this.zooming) && this.options.transition && hasClass(image, CLASS_TRANSITION)) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      // this.image only defined after viewed\n      if (this.viewing || this.viewed) {\n        var image = this.image;\n\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n\n  var handlers = {\n    click: function click(event) {\n      var options = this.options,\n          imageData = this.imageData;\n      var target = event.target;\n      var action = getData(target, DATA_ACTION);\n\n      if (!action && target.localName === 'img' && target.parentElement.localName === 'li') {\n        target = target.parentElement;\n        action = getData(target, DATA_ACTION);\n      } // Cancel the emulated click when the native click event was triggered.\n\n\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n\n        case 'hide':\n          this.hide();\n          break;\n\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          this.toggle();\n          break;\n\n        case 'reset':\n          this.reset();\n          break;\n\n        case 'prev':\n          this.prev(options.loop);\n          break;\n\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n\n        case 'next':\n          this.next(options.loop);\n          break;\n\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (this.played) {\n            this.stop();\n          }\n\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        } // XXX: No pageX/Y properties in custom event, fallback to the original event.\n\n\n        this.toggle(event.isTrusted ? event : event.detail && event.detail.originalEvent);\n      }\n    },\n    load: function load() {\n      var _this = this;\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n\n      var element = this.element,\n          options = this.options,\n          image = this.image,\n          index = this.index,\n          viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:relative;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          }, {\n            cancelable: false\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n\n      if (!options.keyboard) {\n        return;\n      }\n\n      var keyCode = event.keyCode || event.which || event.charCode;\n\n      switch (keyCode) {\n        // Enter\n        case 13:\n          if (this.viewer.contains(event.target)) {\n            this.click(event);\n          }\n\n          break;\n      }\n\n      if (!this.fulled) {\n        return;\n      }\n\n      switch (keyCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n        // Space\n\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n\n          break;\n        // ArrowLeft\n\n        case 37:\n          this.prev(options.loop);\n          break;\n        // ArrowUp\n\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom in\n\n          this.zoom(options.zoomRatio, true);\n          break;\n        // ArrowRight\n\n        case 39:\n          this.next(options.loop);\n          break;\n        // ArrowDown\n\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom out\n\n          this.zoom(-options.zoomRatio, true);\n          break;\n        // Ctrl + 0\n\n        case 48: // Fall through\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.localName === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var buttons = event.buttons,\n          button = event.button;\n\n      if (!this.viewed || this.showing || this.viewing || this.hiding // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      } // Prevent default behaviours as page zooming in touch devices.\n\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      var action = options.movable ? ACTION_MOVE : false;\n\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n          action = this.action;\n\n      if (!this.viewed || !action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n\n      var options = this.options,\n          action = this.action,\n          pointers = this.pointers;\n      var pointer;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = false; // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false; // This timeout will be cleared later when a native dblclick event is triggering\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          } else {\n            this.imageClicked = true; // The default timing of a double click in Windows is 500 ms\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK, {\n                originalEvent: event\n              });\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n\n      if (!this.viewed) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, true, event);\n    }\n  };\n\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n\n      if (!this.ready) {\n        this.build();\n\n        if (this.ready) {\n          this.show(immediate);\n        }\n\n        return this;\n      }\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('aria-hidden');\n\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n\n      return this;\n    },\n\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var _this = this;\n\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n\n      this.hiding = true;\n\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var viewer = this.viewer,\n          image = this.image;\n\n      var hideImmediately = function hideImmediately() {\n        removeClass(viewer, CLASS_IN);\n\n        _this.hidden();\n      };\n\n      if (options.transition && !immediate) {\n        var onViewerTransitionEnd = function onViewerTransitionEnd(event) {\n          // Ignore all propagating `transitionend` events (#275).\n          if (event && event.target === viewer) {\n            removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n\n            _this.hidden();\n          }\n        };\n\n        var onImageTransitionEnd = function onImageTransitionEnd() {\n          // In case of show the viewer by `viewer.show(true)` previously (#407).\n          if (hasClass(viewer, CLASS_TRANSITION)) {\n            addListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            removeClass(viewer, CLASS_IN);\n          } else {\n            hideImmediately();\n          }\n        };\n\n        this.transitioning = {\n          abort: function abort() {\n            if (_this.viewed && hasClass(image, CLASS_TRANSITION)) {\n              removeListener(image, EVENT_TRANSITION_END, onImageTransitionEnd);\n            } else if (hasClass(viewer, CLASS_TRANSITION)) {\n              removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            }\n          }\n        }; // In case of hiding the viewer when holding on the image (#255),\n        // note that the `CLASS_TRANSITION` class will be removed on pointer down.\n\n        if (this.viewed && hasClass(image, CLASS_TRANSITION)) {\n          addListener(image, EVENT_TRANSITION_END, onImageTransitionEnd, {\n            once: true\n          });\n          this.zoomTo(0, false, null, true);\n        } else {\n          onImageTransitionEnd();\n        }\n      } else {\n        hideImmediately();\n      }\n\n      return this;\n    },\n\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this2 = this;\n\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var element = this.element,\n          options = this.options,\n          title = this.title,\n          canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n\n      var activeItem = this.items[this.index];\n\n      if (activeItem) {\n        removeClass(activeItem, CLASS_ACTIVE);\n        activeItem.removeAttribute('aria-selected');\n      }\n\n      addClass(item, CLASS_ACTIVE);\n      item.setAttribute('aria-selected', true);\n\n      if (options.focus) {\n        item.focus();\n      }\n\n      this.image = image;\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n\n      canvas.innerHTML = '';\n      canvas.appendChild(image); // Center current item\n\n      this.renderList(); // Clear title\n\n      title.innerHTML = ''; // Generate title after viewed\n\n      var onViewed = function onViewed() {\n        var imageData = _this2.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this2, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n\n      var onLoad;\n      var onError;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n\n          if (image.complete) {\n            if (_this2.imageRendering) {\n              _this2.imageRendering.abort();\n            } else if (_this2.imageInitializing) {\n              _this2.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n\n            if (_this2.timeout) {\n              clearTimeout(_this2.timeout);\n            }\n          }\n        }\n      };\n\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n          removeListener(image, EVENT_ERROR, onError);\n\n          _this2.load();\n        }, {\n          once: true\n        });\n        addListener(image, EVENT_ERROR, onError = function onError() {\n          removeListener(image, EVENT_LOAD, onLoad);\n\n          if (_this2.timeout) {\n            clearTimeout(_this2.timeout);\n            _this2.timeout = false;\n          }\n\n          removeClass(image, CLASS_INVISIBLE);\n\n          if (options.loading) {\n            removeClass(_this2.canvas, CLASS_LOADING);\n          }\n        }, {\n          once: true\n        });\n\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        } // Make the image visible if it fails to load within 1s\n\n\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this2.timeout = false;\n        }, 1000);\n      }\n\n      return this;\n    },\n\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * Move the image with relative offsets.\n     * @param {number} x - The moving distance in the horizontal direction.\n     * @param {number} [y=x] The moving distance in the vertical direction.\n     * @returns {Viewer} this\n     */\n    move: function move(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(x) ? x : imageData.x + Number(x), isUndefined(y) ? y : imageData.y + Number(y));\n      return this;\n    },\n\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The new position in the horizontal direction.\n     * @param {number} [y=x] - The new position in the vertical direction.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var _this3 = this;\n\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.viewed && !this.played && options.movable) {\n        var oldX = imageData.x;\n        var oldY = imageData.y;\n        var changed = false;\n\n        if (isNumber(x)) {\n          changed = true;\n        } else {\n          x = oldX;\n        }\n\n        if (isNumber(y)) {\n          changed = true;\n        } else {\n          y = oldY;\n        }\n\n        if (changed) {\n          if (isFunction(options.move)) {\n            addListener(element, EVENT_MOVE, options.move, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_MOVE, {\n            x: x,\n            y: y,\n            oldX: oldX,\n            oldY: oldY,\n            originalEvent: _originalEvent\n          }) === false) {\n            return this;\n          }\n\n          imageData.x = x;\n          imageData.y = y;\n          imageData.left = x;\n          imageData.top = y;\n          this.moving = true;\n          this.renderImage(function () {\n            _this3.moving = false;\n\n            if (isFunction(options.moved)) {\n              addListener(element, EVENT_MOVED, options.moved, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_MOVED, {\n              x: x,\n              y: y,\n              oldX: oldX,\n              oldY: oldY,\n              originalEvent: _originalEvent\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var _this4 = this;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.viewed && !this.played && options.rotatable) {\n        var oldDegree = imageData.rotate;\n\n        if (isFunction(options.rotate)) {\n          addListener(element, EVENT_ROTATE, options.rotate, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ROTATE, {\n          degree: degree,\n          oldDegree: oldDegree\n        }) === false) {\n          return this;\n        }\n\n        imageData.rotate = degree;\n        this.rotating = true;\n        this.renderImage(function () {\n          _this4.rotating = false;\n\n          if (isFunction(options.rotated)) {\n            addListener(element, EVENT_ROTATED, options.rotated, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ROTATED, {\n            degree: degree,\n            oldDegree: oldDegree\n          }, {\n            cancelable: false\n          });\n        });\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var _this5 = this;\n\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.viewed && !this.played && options.scalable) {\n        var oldScaleX = imageData.scaleX;\n        var oldScaleY = imageData.scaleY;\n        var changed = false;\n\n        if (isNumber(scaleX)) {\n          changed = true;\n        } else {\n          scaleX = oldScaleX;\n        }\n\n        if (isNumber(scaleY)) {\n          changed = true;\n        } else {\n          scaleY = oldScaleY;\n        }\n\n        if (changed) {\n          if (isFunction(options.scale)) {\n            addListener(element, EVENT_SCALE, options.scale, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_SCALE, {\n            scaleX: scaleX,\n            scaleY: scaleY,\n            oldScaleX: oldScaleX,\n            oldScaleY: oldScaleY\n          }) === false) {\n            return this;\n          }\n\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n          this.scaling = true;\n          this.renderImage(function () {\n            _this5.scaling = false;\n\n            if (isFunction(options.scaled)) {\n              addListener(element, EVENT_SCALED, options.scaled, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_SCALED, {\n              scaleX: scaleX,\n              scaleY: scaleY,\n              oldScaleX: oldScaleX,\n              oldScaleY: oldScaleY\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n      return this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this6 = this;\n\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _zoomable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n      var element = this.element,\n          options = this.options,\n          pointers = this.pointers,\n          imageData = this.imageData;\n      var x = imageData.x,\n          y = imageData.y,\n          width = imageData.width,\n          height = imageData.height,\n          naturalWidth = imageData.naturalWidth,\n          naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (_originalEvent) {\n          switch (_originalEvent.type) {\n            case 'wheel':\n              if (options.zoomRatio >= 0.055 && ratio > 0.95 && ratio < 1.05) {\n                ratio = 1;\n              }\n\n              break;\n\n            case 'pointermove':\n            case 'touchmove':\n            case 'mousemove':\n              if (ratio > 0.99 && ratio < 1.01) {\n                ratio = 1;\n              }\n\n              break;\n          }\n        }\n\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = imageData.ratio;\n\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        this.zooming = true;\n\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length > 0 ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          imageData.x -= offsetWidth * ((center.pageX - offset.left - x) / width);\n          imageData.y -= offsetHeight * ((center.pageY - offset.top - y) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.x -= offsetWidth / 2;\n          imageData.y -= offsetHeight / 2;\n        }\n\n        imageData.left = imageData.x;\n        imageData.top = imageData.y;\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.oldRatio = oldRatio;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this6.zooming = false;\n\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          }, {\n            cancelable: false\n          });\n        });\n\n        if (hasTooltip) {\n          this.tooltip();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Play the images\n     * @param {boolean|FullscreenOptions} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this7 = this;\n\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isShown || this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.play)) {\n        addListener(element, EVENT_PLAY, options.play, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_PLAY) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n\n      if (fullscreen) {\n        this.requestFullscreen(fullscreen);\n      }\n\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        var play = function play() {\n          _this7.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index += 1;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n            play();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          play();\n        }\n      }\n\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this8 = this;\n\n      if (!this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.stop)) {\n        addListener(element, EVENT_STOP, options.stop, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_STOP) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      this.played = false;\n      clearTimeout(this.playing);\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this8.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this9 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('style');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n\n      if (options.focus) {\n        this.enforceFocus();\n      }\n\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this9.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this10 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      if (options.focus) {\n        this.clearEnforceFocus();\n      }\n\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this10.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this11 = this;\n\n      var options = this.options,\n          tooltipBox = this.tooltipBox,\n          imageData = this.imageData;\n\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          tooltipBox.removeAttribute('aria-hidden'); // Force reflow to enable CSS3 transition\n\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.removeAttribute('aria-hidden');\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            tooltipBox.setAttribute('aria-hidden', true);\n            _this11.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this11.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.setAttribute('aria-hidden', true);\n        }\n\n        _this11.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n\n    /**\n     * Toggle the image size between its current size and natural size\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    toggle: function toggle() {\n      var _originalEvent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.imageData.oldRatio, true, _originalEvent);\n      } else {\n        this.zoomTo(1, true, _originalEvent);\n      }\n\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this12 = this;\n\n      var element = this.element,\n          options = this.options,\n          isImg = this.isImg; // Destroy viewer if the target image was deleted\n\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this12, image)) {\n            images.push(image);\n          }\n        } else if (_this12.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n\n      if (!images.length) {\n        return this;\n      }\n\n      this.images = images;\n      this.length = images.length;\n\n      if (this.ready) {\n        var changedIndexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n\n          if (image && img) {\n            if (image.src !== img.src // Title changed (#408)\n            || image.alt !== img.alt) {\n              changedIndexes.push(i);\n            }\n          } else {\n            changedIndexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var changedIndex = changedIndexes.indexOf(this.index);\n\n              if (changedIndex >= 0) {\n                this.viewed = false;\n                this.view(Math.max(Math.min(this.index - changedIndex, this.length - 1), 0));\n              } else {\n                var activeItem = this.items[this.index]; // Reactivate the current viewing item after reset the list.\n\n                addClass(activeItem, CLASS_ACTIVE);\n                activeItem.setAttribute('aria-selected', true);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n          options = this.options;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      this.destroyed = true;\n\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n\n      return url;\n    },\n    enforceFocus: function enforceFocus() {\n      var _this = this;\n\n      this.clearEnforceFocus();\n      addListener(document, EVENT_FOCUSIN, this.onFocusin = function (event) {\n        var viewer = _this.viewer;\n        var target = event.target;\n\n        if (target === document || target === viewer || viewer.contains(target)) {\n          return;\n        }\n\n        while (target) {\n          // Avoid conflicts with other modals (#474, #540)\n          if (target.getAttribute('tabindex') !== null || target.getAttribute('aria-modal') === 'true') {\n            return;\n          }\n\n          target = target.parentElement;\n        }\n\n        viewer.focus();\n      });\n    },\n    clearEnforceFocus: function clearEnforceFocus() {\n      if (this.onFocusin) {\n        removeListener(document, EVENT_FOCUSIN, this.onFocusin);\n        this.onFocusin = null;\n      }\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.initialBodyPaddingRight;\n    },\n    shown: function shown() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n\n      if (options.focus) {\n        viewer.focus();\n        this.enforceFocus();\n      }\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n\n      if (options.fucus) {\n        this.clearEnforceFocus();\n      }\n\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.close();\n      this.unbind();\n      addClass(viewer, CLASS_HIDE);\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      viewer.setAttribute('aria-hidden', true);\n      this.resetList();\n      this.resetImage();\n      this.hiding = false;\n\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_HIDDEN, null, {\n          cancelable: false\n        });\n      }\n    },\n    requestFullscreen: function requestFullscreen(options) {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement; // Element.requestFullscreen()\n\n        if (documentElement.requestFullscreen) {\n          // Avoid TypeError when convert `options` to dictionary\n          if (isPlainObject(options)) {\n            documentElement.requestFullscreen(options);\n          } else {\n            documentElement.requestFullscreen();\n          }\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]]; // In the case of the `pointers` object is empty (#421)\n\n      if (!pointer) {\n        return;\n      }\n\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          this.move(offsetX, offsetY, event);\n          break;\n        // Zoom the current image\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, event);\n          break;\n\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n\n            break;\n          }\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n          viewerData = this.viewerData;\n      return this.length > 1 && imageData.x >= 0 && imageData.y >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n\n  var AnotherViewer = WINDOW.Viewer;\n\n  var getUniqueID = function (id) {\n    return function () {\n      id += 1;\n      return id;\n    };\n  }(-1);\n\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Viewer);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.moving = false;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.rotating = false;\n      this.scaling = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.id = getUniqueID();\n      this.init();\n    }\n\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var element = this.element,\n            options = this.options;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this; // The `focus` option requires the `keyboard` option set to `true`.\n\n        if (options.focus && !options.keyboard) {\n          options.focus = false;\n        }\n\n        var isImg = element.localName === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody(); // Override `transition` option if it is not supported\n\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n\n        if (options.inline) {\n          var count = 0;\n\n          var progress = function progress() {\n            count += 1;\n\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              }; // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n\n                _this.build();\n              }, 0);\n            }\n          };\n\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                  removeListener(image, EVENT_ERROR, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              var onLoad;\n              var onError;\n              addListener(image, EVENT_LOAD, onLoad = function onLoad() {\n                removeListener(image, EVENT_ERROR, onError);\n                progress();\n              }, {\n                once: true\n              });\n              addListener(image, EVENT_ERROR, onError = function onError() {\n                removeListener(image, EVENT_LOAD, onLoad);\n                progress();\n              }, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n\n            if (target.localName === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        viewer.id = \"\".concat(NAMESPACE).concat(this.id);\n        title.id = \"\".concat(NAMESPACE, \"Title\").concat(this.id);\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n\n        if (options.keyboard) {\n          button.setAttribute('tabindex', 0);\n        }\n\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n\n            if (options.keyboard) {\n              item.setAttribute('tabindex', 0);\n            }\n\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n\n          if (!container) {\n            container = this.body;\n          }\n\n          container.appendChild(viewer);\n        }\n\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n\n        this.ready = true;\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Viewer;\n  }();\n\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n\n  return Viewer;\n\n}));\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}